import{c as P}from"./js/runtime-dom.esm-bundler.36191dca.js";import{l as v}from"./js/index.9d0df22d.js";import{l as E}from"./js/index.9c2681d6.js";import{l as b}from"./js/index.d80c2c2c.js";import{u as B,m as $,N as k,O as A,l as _,a3 as C}from"./js/index.6205915e.js";import{e as N}from"./js/elemLoaded.2921fc72.js";import{a as I,b as L,g as q,t as V,c as F}from"./js/helpers.c3d026e6.js";import{C as M}from"./js/Tooltip.e5a30815.js";import{S as O}from"./js/Trash.544ebd43.js";import{E as U,F as H}from"./js/helpers.7981a424.js";import"./js/translations.e71e2202.js";import{_ as w}from"./js/_plugin-vue_export-helper.eefbdd86.js";import{b as Q}from"./js/_baseIteratee.a1a0972d.js";import{b as z}from"./js/_basePickBy.1bb6b08b.js";import{g as K}from"./js/_getAllKeysIn.2e381a54.js";import{a as c,_ as l}from"./js/default-i18n.65d58dd6.js";import{a7 as m,o as T,a3 as x,a4 as u,t as d,q as p,w as y,a as R,b as D}from"./js/runtime-core.esm-bundler.50cb9e6d.js";import"./js/Button.898cae57.js";import"./js/Input.2db511a5.js";import"./js/Index.92195ca4.js";import"./js/Close.650e0e8f.js";import"./js/Pencil.1f4e936a.js";import"./js/Select.ed8403e2.js";import"./js/Caret.19d3d4d0.js";import"./js/Toggle.6b4c4eee.js";import"./js/_baseIsEqual.45a50e56.js";import"./js/_getTag.47f014a4.js";function G(t,e){if(t==null)return{};var o=U(K(t),function(r){return[r]});return e=Q(e),z(t,o,function(r,s){return e(r,s[0])})}const f="aioseo-pro",J={setup(){return{postEditorStore:B()}},components:{CoreTooltip:M,SvgCircleQuestionMark:O},props:{taxonomy:String},data(){return{term:null,terms:[],selectedTerms:[]}},watch:{terms(t){if(!this.term&&t&&this.postEditorStore.currentPost.primary_term[this.taxonomy]){const e=t.find(o=>o.value===this.postEditorStore.currentPost.primary_term[this.taxonomy]);this.setPrimaryTerm(e)}},selectedTerms(t,e){if(e.length<t.length){const o=t.filter(r=>!e.includes(r))[0];this.terms.some(r=>r.value===o)||this.updateTerms()}this.term&&this.term.value&&!t.includes(this.term.value)&&this.setPrimaryTerm(null)}},computed:{taxonomyName(){return I(this.taxonomy).singular},toolTipText(){return c(l("%1$s allows you to choose a primary %2$s for your posts. This feature works hand in hand with our powerful Breadcrumbs template to give you full navigational control to help improve your search rankings.",f),"AIOSEO Pro",this.taxonomyName)},labelString(){return c(l("Select Primary %1$s",f),this.taxonomyName)},options(){return this.terms.filter(t=>this.selectedTerms.includes(t.value))}},methods:{setPrimaryTerm(t){this.term=t,window.aioseoBus.$emit("standalone-update-post",{primary_term:G({...this.postEditorStore.currentPost.primary_term,[this.taxonomy]:t&&t.value?t.value:null})})},updateTerms(){L(this.taxonomy).then(t=>{this.terms=[],t.forEach(e=>{this.terms.push({value:e.id,label:H(e.name)})})})},updateSelectedTerms(){this.selectedTerms=q(this.taxonomy)}},mounted(){this.updateTerms(),this.updateSelectedTerms(),window.aioseoBus.$on("updateSelectedTerms",this.updateSelectedTerms)},beforeUnmount(){window.aioseoBus.$off("updateSelectedTerms",this.updateSelectedTerms)}},W={key:0,class:"aioseo-primary-term-select"},X={class:"aioseo-primary-term-select__title"},Y={class:"aioseo-primary-term-select__title-text"};function Z(t,e,o,r,s,i){const a=m("svg-circle-question-mark"),n=m("core-tooltip"),g=m("base-select");return 1<s.selectedTerms.length?(T(),x("div",W,[u("div",X,[u("span",Y,d(i.labelString),1),p(n,{offset:"-200px,0"},{tooltip:y(()=>[R(d(i.toolTipText),1)]),default:y(()=>[p(a)]),_:1})]),p(g,{size:"medium",options:i.options,modelValue:s.term,"onUpdate:modelValue":e[0]||(e[0]=S=>i.setPrimaryTerm(S))},null,8,["options","modelValue"])])):D("",!0)}const j=w(J,[["render",Z]]),tt={components:{PrimaryTerm:j},props:{taxonomy:String}},et={class:"aioseo-app aioseo-primary-term"};function ot(t,e,o,r,s,i){const a=m("primary-term");return T(),x("div",et,[p(a,{taxonomy:o.taxonomy},null,8,["taxonomy"])])}const rt=w(tt,[["render",ot]]);if($()&&window.wp){const{createElement:t,Fragment:e}=window.wp.element,{addFilter:o}=window.wp.hooks,{createHigherOrderComponent:r}=window.wp.compose,{subscribe:s}=window.wp.data;o("editor.PostTaxonomyType","aioseo/primary-term",r(i=>a=>{const{slug:n}=a;return V(n)?t(e,{},t(i,a),t("div",{id:`aioseo-primary-term-${n}`},t("div",{className:"aioseo-primary-term-app",taxonomy:n}))):t(i,a)},"withInspectorControls")),s(()=>{window.aioseoBus.$emit("updateSelectedTerms")})}(k()||A())&&(_(),F().forEach(t=>{var r;const e=(r=document.getElementById(`${t.name}div`))==null?void 0:r.querySelector(".inside");if(!e)return;const o=document.createElement("div");o.setAttribute("id",`aioseo-primary-term-${t.name}`),o.setAttribute("class","aioseo-primary-term-app"),o.setAttribute("taxonomy",t.name),e.append(o),function(s){s(`#${t.name}checklist`).on("change",'input[type="checkbox"]',()=>{window.aioseoBus.$emit("updateSelectedTerms")}),s(`#${t.name}checklist`).on("wpListAddEnd",()=>{window.aioseoBus.$emit("updateSelectedTerms")})}(window.jQuery)}));const h=t=>{if(!t)return;const e=t.getAttribute("taxonomy");let o=P({...rt,name:"Standalone/PrimaryTerm"},{taxonomy:e});o=v(o),o=E(o),o=b(o),_(o),o.mount(t)};if(C()&&window.aioseo&&window.aioseo.currentPost&&window.aioseo.currentPost.context==="post"){const t=document.getElementsByClassName("aioseo-primary-term-app");Array.prototype.forEach.call(t,e=>h(e)),N(".aioseo-primary-term-app","aioseoPrimaryTerm"),document.addEventListener("animationstart",function(e){e.animationName==="aioseoPrimaryTerm"&&h(e.target)},{passive:!0})}
